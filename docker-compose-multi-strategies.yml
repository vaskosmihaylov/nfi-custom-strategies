---
# Multi-Strategy FreqTrade Docker Compose Configuration
# This file sets up multiple FreqTrade containers for different strategies

x-common-settings: &common-settings
  image: freqtradeorg/freqtrade:stable
  build:
    context: .
    dockerfile: "./docker/Dockerfile.custom"
  restart: unless-stopped
  volumes:
    - "./user_data:/freqtrade/user_data"
    - "./user_data/data:/freqtrade/user_data/data"
    - "./configs:/freqtrade/configs"
    # Mount root-level strategy files (needed for symlinks to work)
    - "./NostalgiaForInfinityX7.py:/freqtrade/NostalgiaForInfinityX7.py:ro"
    - "./NostalgiaForInfinityX6.py:/freqtrade/NostalgiaForInfinityX6.py:ro"
    - "./NostalgiaForInfinityX5.py:/freqtrade/NostalgiaForInfinityX5.py:ro"
  healthcheck:
    test: ["CMD", "curl", "-f", "http://localhost:8080"]
    interval: 1m30s
    timeout: 10s
    retries: 3
    start_period: 40s
    start_interval: 5s

services:
  # NostalgiaForInfinityX7 Strategy (uses upstream symlink)
  freqtrade-nfi-x7:
    <<: *common-settings
    container_name: freqtrade-nfi-x7
    ports:
      - "127.0.0.1:8080:8080"
    env_file:
      - path: ./env-files/nfi-x7.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/nfi-x7-tradesv3.sqlite
      --log-file user_data/logs/nfi-x7.log
      --strategy-path user_data/strategies
      --strategy NostalgiaForInfinityX7

  # FalconTrader Strategy (Longs with DCA)
  freqtrade-falcontrader:
    <<: *common-settings
    container_name: freqtrade-falcontrader
    ports:
      - "127.0.0.1:8092:8080"
    env_file:
      - path: ./env-files/falcontrader.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/falcontrader-tradesv3.sqlite
      --log-file user_data/logs/falcontrader.log
      --strategy-path user_data/strategies/FalconTrader
      --strategy newstrategy53

  # FalconTrader_Short Strategy (Shorts with 3x leverage and DCA)
  freqtrade-falcontrader_short:
    <<: *common-settings
    container_name: freqtrade-falcontrader_short
    ports:
      - "127.0.0.1:8094:8080"
    env_file:
      - path: ./env-files/falcontrader_short.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/falcontrader_short-tradesv3.sqlite
      --log-file user_data/logs/falcontrader_short.log
      --strategy-path user_data/strategies/FalconTrader
      --strategy newstrategy53_shorts

  # E0V1E Strategy (Longs)
  freqtrade-e0v1e:
    <<: *common-settings
    container_name: freqtrade-e0v1e
    ports:
      - "127.0.0.1:8098:8080"
    env_file:
      - path: ./env-files/e0v1e.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/e0v1e-tradesv3.sqlite
      --log-file user_data/logs/e0v1e.log
      --strategy-path user_data/strategies/e0v1e
      --strategy E0V1E

  # E0V1E_Shorts Strategy (Shorts-only parallel test)
  freqtrade-e0v1e_shorts:
    <<: *common-settings
    container_name: freqtrade-e0v1e_shorts
    ports:
      - "127.0.0.1:8099:8080"
    env_file:
      - path: ./env-files/e0v1e_shorts.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/e0v1e_shorts-tradesv3.sqlite
      --log-file user_data/logs/e0v1e_shorts.log
      --strategy-path user_data/strategies/e0v1e
      --strategy E0V1E_Shorts

  # Auto_EI_t4c0s Strategy (Longs - replaces EI4_t4c0s_V2_2)
  freqtrade-auto_ei_t4c0s:
    <<: *common-settings
    container_name: freqtrade-auto_ei_t4c0s
    ports:
      - "127.0.0.1:8100:8080"
    env_file:
      - path: ./env-files/auto_ei_t4c0s.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/auto_ei_t4c0s-tradesv3.sqlite
      --log-file user_data/logs/auto_ei_t4c0s.log
      --strategy-path user_data/strategies/El
      --strategy Auto_EI_t4c0s

  # Auto_EI_t4c0s_Shorts Strategy (Shorts-only - replaces EI4_t4c0s_V2_2_Shorts)
  freqtrade-auto_ei_t4c0s_shorts:
    <<: *common-settings
    container_name: freqtrade-auto_ei_t4c0s_shorts
    ports:
      - "127.0.0.1:8101:8080"
    env_file:
      - path: ./env-files/auto_ei_t4c0s_shorts.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/auto_ei_t4c0s_shorts-tradesv3.sqlite
      --log-file user_data/logs/auto_ei_t4c0s_shorts.log
      --strategy-path user_data/strategies/El
      --strategy Auto_EI_t4c0s_Shorts

  # ETCG Strategy (Longs)
  freqtrade-etcg:
    <<: *common-settings
    container_name: freqtrade-etcg
    ports:
      - "127.0.0.1:8102:8080"
    env_file:
      - path: ./env-files/etcg.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/etcg-tradesv3.sqlite
      --log-file user_data/logs/etcg.log
      --strategy-path user_data/strategies/ETCG
      --strategy ETCG

  # ETCG_Shorts Strategy (Shorts-only)
  freqtrade-etcg_shorts:
    <<: *common-settings
    container_name: freqtrade-etcg_shorts
    ports:
      - "127.0.0.1:8103:8080"
    env_file:
      - path: ./env-files/etcg_shorts.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/etcg_shorts-tradesv3.sqlite
      --log-file user_data/logs/etcg_shorts.log
      --strategy-path user_data/strategies/ETCG
      --strategy ETCG_Shorts

  # ClucHAnix_hhll Strategy (Longs)
  freqtrade-cluchanix-hhll:
    <<: *common-settings
    container_name: freqtrade-cluchanix-hhll
    ports:
      - "127.0.0.1:8106:8080"
    env_file:
      - path: ./env-files/cluchanix_hhll.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/cluchanix_hhll-tradesv3.sqlite
      --log-file user_data/logs/cluchanix_hhll.log
      --strategy-path user_data/strategies/Cluc
      --strategy ClucHAnix_hhll

  # ClucHAnix_hhll_Shorts Strategy (Shorts-only)
  freqtrade-cluchanix-hhll-shorts:
    <<: *common-settings
    container_name: freqtrade-cluchanix-hhll-shorts
    ports:
      - "127.0.0.1:8107:8080"
    env_file:
      - path: ./env-files/cluchanix_hhll_shorts.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/cluchanix_hhll_shorts-tradesv3.sqlite
      --log-file user_data/logs/cluchanix_hhll_shorts.log
      --strategy-path user_data/strategies/Cluc
      --strategy ClucHAnix_hhll_Shorts

  # AwesomeEWOLambo Strategy (Longs)
  freqtrade-awesomeewolambo:
    <<: *common-settings
    container_name: freqtrade-awesomeewolambo
    ports:
      - "127.0.0.1:8108:8080"
    env_file:
      - path: ./env-files/awesomeewolambo.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/awesomeewolambo-tradesv3.sqlite
      --log-file user_data/logs/awesomeewolambo.log
      --strategy-path user_data/strategies/AwesomeEWOLambo
      --strategy AwesomeEWOLambo

  # AwesomeEWOLambo_Shorts Strategy (Shorts)
  freqtrade-awesomeewolambo_shorts:
    <<: *common-settings
    container_name: freqtrade-awesomeewolambo_shorts
    ports:
      - "127.0.0.1:8109:8080"
    env_file:
      - path: ./env-files/awesomeewolambo_shorts.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/awesomeewolambo_shorts-tradesv3.sqlite
      --log-file user_data/logs/awesomeewolambo_shorts.log
      --strategy-path user_data/strategies/AwesomeEWOLambo
      --strategy AwesomeEWOLambo_Shorts

  # BB_RPB_TSL_RNG_TBS_GOLD Strategy (Longs)
  freqtrade-bb_rpb_tsl_rng_tbs_gold:
    <<: *common-settings
    container_name: freqtrade-bb_rpb_tsl_rng_tbs_gold
    ports:
      - "127.0.0.1:8110:8080"
    env_file:
      - path: ./env-files/bb_rpb_tsl_rng_tbs_gold.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/bb_rpb_tsl_rng_tbs_gold-tradesv3.sqlite
      --log-file user_data/logs/bb_rpb_tsl_rng_tbs_gold.log
      --strategy-path user_data/strategies/BB_RPB_TSL_RNG_TBS_GOLD
      --strategy BB_RPB_TSL_RNG_TBS_GOLD

  # BB_RPB_TSL_RNG_TBS_GOLD_Shorts Strategy (Shorts Only)
  freqtrade-bb_rpb_tsl_rng_tbs_gold_shorts:
    <<: *common-settings
    container_name: freqtrade-bb_rpb_tsl_rng_tbs_gold_shorts
    ports:
      - "127.0.0.1:8111:8080"
    env_file:
      - path: ./env-files/bb_rpb_tsl_rng_tbs_gold_shorts.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/bb_rpb_tsl_rng_tbs_gold_shorts-tradesv3.sqlite
      --log-file user_data/logs/bb_rpb_tsl_rng_tbs_gold_shorts.log
      --strategy-path user_data/strategies/BB_RPB_TSL_RNG_TBS_GOLD
      --strategy BB_RPB_TSL_RNG_TBS_GOLD_Shorts

  # GeneStrategy_v2 Strategy (Longs)
  freqtrade-genestrategy_v2:
    <<: *common-settings
    container_name: freqtrade-genestrategy_v2
    ports:
      - "127.0.0.1:8114:8080"
    env_file:
      - path: ./env-files/genestrategy_v2.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/genestrategy_v2-tradesv3.sqlite
      --log-file user_data/logs/genestrategy_v2.log
      --strategy-path user_data/strategies/GeneTrader
      --strategy GeneStrategy_v2

  # GeneStrategy_v2_Shorts Strategy (Shorts Only)
  freqtrade-genestrategy_v2_shorts:
    <<: *common-settings
    container_name: freqtrade-genestrategy_v2_shorts
    ports:
      - "127.0.0.1:8115:8080"
    env_file:
      - path: ./env-files/genestrategy_v2_shorts.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/genestrategy_v2_shorts-tradesv3.sqlite
      --log-file user_data/logs/genestrategy_v2_shorts.log
      --strategy-path user_data/strategies/GeneTrader
      --strategy GeneStrategy_v2_Shorts

  # KamaFama Strategy (Longs)
  freqtrade-kamafama:
    <<: *common-settings
    container_name: freqtrade-kamafama
    ports:
      - "127.0.0.1:8091:8080"
    env_file:
      - path: ./env-files/kamafama.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/kamafama-tradesv3.sqlite
      --log-file user_data/logs/kamafama.log
      --strategy-path user_data/strategies/KamaFama
      --strategy KamaFama_2_20250115

  # KamaFama_Shorts Strategy (Shorts Only)
  freqtrade-kamafama_shorts:
    <<: *common-settings
    container_name: freqtrade-kamafama_shorts
    ports:
      - "127.0.0.1:8093:8080"
    env_file:
      - path: ./env-files/kamafama_shorts.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/kamafama_shorts-tradesv3.sqlite
      --log-file user_data/logs/kamafama_shorts.log
      --strategy-path user_data/strategies/KamaFama
      --strategy KamaFama_2_20250115_Shorts

  # HarmonicDivergence Strategy (Longs)
  freqtrade-harmonicdivergence:
    <<: *common-settings
    container_name: freqtrade-harmonicdivergence
    ports:
      - "127.0.0.1:8116:8080"
    env_file:
      - path: ./env-files/harmonicdivergence.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/harmonicdivergence-tradesv3.sqlite
      --log-file user_data/logs/harmonicdivergence.log
      --strategy-path user_data/strategies/Harmonic-divergence
      --strategy HarmonicDivergence_fix

  # HarmonicDivergence_Shorts Strategy (Shorts Only)
  freqtrade-harmonicdivergence_shorts:
    <<: *common-settings
    container_name: freqtrade-harmonicdivergence_shorts
    ports:
      - "127.0.0.1:8117:8080"
    env_file:
      - path: ./env-files/harmonicdivergence_shorts.env
        required: true
    command: >
      trade
      --config user_data/strategies/config.json
      --db-url sqlite:////freqtrade/user_data/harmonicdivergence_shorts-tradesv3.sqlite
      --log-file user_data/logs/harmonicdivergence_shorts.log
      --strategy-path user_data/strategies/Harmonic-divergence
      --strategy HarmonicDivergence_Shorts

networks:
  default:
    name: freqtrade-network
